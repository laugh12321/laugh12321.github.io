<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
<title>机器学习|决策树详解 (Python 语言描述) - Laugh&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="决策树是一种特殊的树形结构，一般由节点和有向边组成。其中，节点表示特征、属性或者一个类，而有向边包含判断条件。决策树从根节点开始延伸，经过不同的判断条件后，到达不同的子节点。而上层子节点又可以作为父节点被进一步划分为下层子节点。一般情况下，我们从根节点输入数据，经过多次判断后，这些数据就会被分为不同的类别。这就构成了一颗简单的分类决策树。">
<meta name="keywords" content="python,machine learning,decision tree">
<meta property="og:type" content="article">
<meta property="og:title" content="机器学习|决策树详解 (Python 语言描述)">
<meta property="og:url" content="https://www.laugh12321.cn/2019/02/01/Decision_Tree/index.html">
<meta property="og:site_name" content="Laugh&#39;s blog">
<meta property="og:description" content="决策树是一种特殊的树形结构，一般由节点和有向边组成。其中，节点表示特征、属性或者一个类，而有向边包含判断条件。决策树从根节点开始延伸，经过不同的判断条件后，到达不同的子节点。而上层子节点又可以作为父节点被进一步划分为下层子节点。一般情况下，我们从根节点输入数据，经过多次判断后，这些数据就会被分为不同的类别。这就构成了一颗简单的分类决策树。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/1.png">
<meta property="og:image" content="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/2.png">
<meta property="og:image" content="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/output_157_0.svg">
<meta property="og:updated_time" content="2019-02-09T13:18:46.121Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="机器学习|决策树详解 (Python 语言描述)">
<meta name="twitter:description" content="决策树是一种特殊的树形结构，一般由节点和有向边组成。其中，节点表示特征、属性或者一个类，而有向边包含判断条件。决策树从根节点开始延伸，经过不同的判断条件后，到达不同的子节点。而上层子节点又可以作为父节点被进一步划分为下层子节点。一般情况下，我们从根节点输入数据，经过多次判断后，这些数据就会被分为不同的类别。这就构成了一颗简单的分类决策树。">
<meta name="twitter:image" content="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/1.png">





<link rel="icon" href="https://avatars0.githubusercontent.com/u/38065710?s=400&u=80ee4d360562451484188e6f1677fa442720891b&v=4">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atelier-sulphurpool-dark.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
<script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?b159f3ddbb6d9197633e49de94480102";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    


<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="is-3-column">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="机器学习|决策树详解 (Python 语言描述)" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="http://github.com/laugh12321">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    

    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/08.jpg" alt="机器学习|决策树详解 (Python 语言描述)">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-01-31T16:00:00.000Z">2019-02-01</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/机器学习/决策树/">决策树</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    44 分钟 读完 (大约 6610 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                机器学习|决策树详解 (Python 语言描述)
            
        </h1>
        <div class="content">
            <p>决策树是一种特殊的树形结构，一般由节点和有向边组成。其中，节点表示特征、属性或者一个类，而有向边包含判断条件。决策树从根节点开始延伸，经过不同的判断条件后，到达不同的子节点。而上层子节点又可以作为父节点被进一步划分为下层子节点。一般情况下，我们从根节点输入数据，经过多次判断后，这些数据就会被分为不同的类别。这就构成了一颗简单的分类决策树。<br><a id="more"></a><br>举一个通俗的例子，假设在B站工作多年仍然单身的小B和他母亲在给他介绍对象时的一段对话：  </p>
<blockquote>
<p>母亲：小B，你都 28 了还是单身，明天亲戚家要来个姑娘要不要去见见。<br>小B：多大年纪？<br>母亲：26。<br>小B：有多高？<br>母亲：165厘米。<br>小B：长的好看不。<br>母亲：还行，比较朴素。<br>小B：温柔不？<br>母亲：看起来挺温柔的，很有礼貌。<br>小B：好，去见见。</p>
</blockquote>
<p>作为程序员的小B的思考逻辑就是典型的决策树分类逻辑，将年龄，身高，长相，是否温柔作为特征，并最后对见或者不见进行决策。其决策逻辑如图所示：</p>
<center><img src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/1.png" width="300" height="300"></center>

<h2 id="决策树算法实现"><a href="#决策树算法实现" class="headerlink" title="决策树算法实现"></a>决策树算法实现</h2><p>其实决策树算法如同上面场景一样，其思想非常容易理解，具体的算法流程为：  </p>
<ul>
<li><p><strong>第 1 步</strong>: 数据准备：通过数据清洗和数据处理，将数据整理为没有缺省值的向量。  </p>
</li>
<li><p><strong>第 2 步</strong>: 寻找最佳特征：遍历每个特征的每一种划分方式，找到最好的划分特征。  </p>
</li>
<li><p><strong>第 3 步</strong>: 生成分支：划分成两个或多个节点。  </p>
</li>
<li><p><strong>第 4 步</strong>: 生成决策树：对分裂后的节点分别继续执行2-3步，直到每个节点只有一种类别。  </p>
</li>
<li><p><strong>第 5 步</strong>: 决策分类：根据训练决策树模型，将预测数据进行分类。  </p>
</li>
</ul>
<h3 id="数据生成"><a href="#数据生成" class="headerlink" title="数据生成"></a>数据生成</h3><p>下面我们依照决策树的算法流程，用 <code>python</code> 来实现决策树构建和分类。首先生成一组数据，数据包含两个类别 <code>man</code> 和 <code>woman</code>,特征分别为:</p>
<ul>
<li><code>hair</code>:头发长短(<code>long</code>:长,<code>short</code>:短)</li>
<li><code>voice</code>:声音粗细(<code>thick</code>:粗,<code>thin</code>:细)</li>
<li><code>height</code>:身高</li>
<li><code>ear_stud</code>:是否带有耳钉(<code>yes</code>:是,<code>no</code>:没有)</li>
</ul>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""生成示例数据</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</span><br><span class="line"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_data</span><span class="hljs-params">()</span>:</span></span><br><span class="line">    data_value = np.array(</span><br><span class="line">        [[<span class="hljs-string">'long'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">175</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'medium'</span>, <span class="hljs-number">168</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">178</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">172</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'medium'</span>, <span class="hljs-number">163</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">180</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">173</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">174</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'man'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">164</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'medium'</span>, <span class="hljs-number">158</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">161</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">166</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">158</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'medium'</span>, <span class="hljs-number">163</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thick'</span>, <span class="hljs-number">161</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'long'</span>, <span class="hljs-string">'thin'</span>, <span class="hljs-number">164</span>, <span class="hljs-string">'no'</span>, <span class="hljs-string">'woman'</span>],</span><br><span class="line">         [<span class="hljs-string">'short'</span>, <span class="hljs-string">'medium'</span>, <span class="hljs-number">172</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'woman'</span>]])</span><br><span class="line">    columns = np.array([<span class="hljs-string">'hair'</span>, <span class="hljs-string">'voice'</span>, <span class="hljs-string">'height'</span>, <span class="hljs-string">'ear_stud'</span>, <span class="hljs-string">'labels'</span>])</span><br><span class="line">    data = pd.DataFrame(data_value.reshape(<span class="hljs-number">17</span>, <span class="hljs-number">5</span>), columns=columns)</span><br><span class="line">    <span class="hljs-keyword">return</span> data</span><br></pre></td></tr></table></figure>
<p>在创建好数据之后，加载并打印出这些数据</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = create_data()</span><br><span class="line">data</span><br></pre></td></tr></table></figure>
<h3 id="划分选择"><a href="#划分选择" class="headerlink" title="划分选择"></a>划分选择</h3><p>在得到数据后，根据算法流程，接下来需要寻找最优的划分特征，随着划分的不断进行，我们尽可能的将划分的分支所包含的样本归于同一类别，即结点的“纯度”越来越高。而常用的特征划分方式为信息增益和增益率。</p>
<h4 id="信息增益（ID3）"><a href="#信息增益（ID3）" class="headerlink" title="信息增益（ID3）"></a>信息增益（ID3）</h4><p>在介绍信息增益之前，先引入“信息熵”的概念。“信息熵”是度量样本纯度最常用的一种指标，其公式为：</p>
<p>$$<br>Ent(D)=-\sum_{k=1}^{\left |y  \right |}p_{k}\; log_{2}p_{k} \tag{1}<br>$$</p>
<p>其中 `D` 表示样本集合，`p_{k}` 表示第 `k` 类样本所占的比例。其中 `Ent(D)` 的值越小，则 `D` 的纯度越高。根据以上数据，在计算数据集的“信息熵”时，\(\left | y \right |\) 显然只有 <code>man</code>,<code>woman</code> 共 2 种，其中为 <code>man</code> 的概率为 \(\frac{8}{17}\), <code>woman</code> 的概率为 \(\frac{9}{17}\),则根据公式(1)得到数据集的纯度为：</p>
<p>$$<br>Ent(data)=-\sum_{k=1}^{2}p_{k}\;log_{2}p_{k}=-(\frac{8}{17}log_{2}\frac{8}{17}+\frac{9}{17}log_{2}\frac{9}{17})=0.9975<br>$$</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""计算信息熵</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_Ent</span><span class="hljs-params">(data)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    Ent -- 信息熵</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    num_sample = len(data)  <span class="hljs-comment"># 样本个数</span></span><br><span class="line">    label_counts = &#123;&#125;  <span class="hljs-comment"># 初始化标签统计字典</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_sample):</span><br><span class="line">        each_data = data.iloc[i, :]</span><br><span class="line">        current_label = each_data[<span class="hljs-string">"labels"</span>]  <span class="hljs-comment"># 得到当前元素的标签（label）</span></span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment"># 如果标签不在当前字典中，添加该类标签并初始化 value=0,否则该类标签 value+1</span></span><br><span class="line">        <span class="hljs-keyword">if</span> current_label <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> label_counts.keys():</span><br><span class="line">            label_counts[current_label] = <span class="hljs-number">0</span></span><br><span class="line">        label_counts[current_label] += <span class="hljs-number">1</span></span><br><span class="line">    </span><br><span class="line">    Ent = <span class="hljs-number">0.0</span>  <span class="hljs-comment"># 初始化信息熵</span></span><br><span class="line">    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> label_counts:</span><br><span class="line">        prob = float(label_counts[key])/num_sample</span><br><span class="line">        Ent -= prob * math.log(prob, <span class="hljs-number">2</span>)  <span class="hljs-comment"># 应用信息熵公式计算信息熵</span></span><br><span class="line">    <span class="hljs-keyword">return</span> Ent</span><br></pre></td></tr></table></figure>
<p>通过计算信息熵函数，计算根节点的信息熵：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">base_ent = get_Ent(data)</span><br><span class="line">base_ent</span><br></pre></td></tr></table></figure>
<pre><code>0.9975025463691153
</code></pre><p><strong>信息增益</strong> 就是建立在信息熵的基础上，在离散特征 `x` 有 `M` 个取值，如果用 `x` 对样本 `D` 来进行划分，就会产生 `M` 个分支，其中第 `m` 个分支包含了集合 `D` 的所有在特征 `x` 上取值为 `m` 的样本，记为 `D^{m}`（例如：根据以上生成数据，如果我们用 <code>hair</code> 进行划分，则会产生<code>long</code>，<code>short</code>两个分支，每一个分支中分别包含了整个集合中属于 <code>long</code> 或者 <code>short</code> 的数据）。</p>
<p>考虑到不同分支节点包含样本数不同，给分支赋予权重 \(\frac{\left | D^{m}\right |}{\left | D \right |}\) ,使得样本越多的分支节点影响越大，则 <strong>信息增益</strong> 的公式就可以得到：</p>
<p>$$<br>Gain(D,x)=Ent(D)- \sum_{m=1}^{M}\frac{\left | D^{m}\right |}{\left | D \right |}Ent(D^{m}) \tag{2}<br>$$</p>
<p>一般情况下，信息增益越大，则说明用 `x` 来划分样本集合 `D` 的纯度越高。以 <code>hair</code> 为例，其中它有 <code>short</code> 和 <code>long</code> 两个可能取值，则分别用 `D^{1}` (hair = long) 和 `D^{2} (hair = short)来表示。</p>
<p>其中为 \(D^{1}\) 的数据编号为 \(\{0，4，6，8，9，10，12，14，15\}\) 共 9 个，在这之中为 <code>man</code> 的有 {0，4，6} 共3 个占比为\(\frac{3}{9}\)，为 <code>woman</code> 的有{8, 9，10，12，14，15}共 6 个占比为\(\frac{6}{9}\); 同样 `D^{2}` 编号为{1，2，3，5，7，11，13, 16}共 8 个，其中为 <code>man</code> 的有{1，2，3，5，7}共 5 个占比\(\frac{5}{8}\),为 <code>woman</code> 的有{11，13, 16}共 3 个占比 \(\frac{3}{8}\),若按照 <code>hair</code> 进行划分，则两个分支点的信息熵为：</p>
<p>$$<br>Ent(D^{1})=-(\frac{3}{9}\;log_{2}\frac{3}{9}+\frac{6}{9}\;log_{2}\frac{6}{9})=0.449<br>$$</p>
<p>$$<br>Ent(D^{2})=-(\frac{5}{8}\;log_{2}\frac{5}{8}+\frac{3}{8}\;log_{2}\frac{3}{8})=0.486<br>$$</p>
<p>根据信息增益的公式可以计算出 <code>hair</code> 的信息增益为：</p>
<p>$$<br>Gain(D,hair)=Ent(D)-\sum_{m=1}^{2}\frac{\left | D^{m} \right |}{\left | D \right |}Ent(D^{m})=0.9975-(\frac{9}{17}*0.449+\frac{8}{17}*0.486)=0.062<br>$$</p>
<p>下面我们用 <code>python</code> 来实现<strong>信息增益（ID3）</strong>算法：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""计算信息增益</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_gain</span><span class="hljs-params">(data, base_ent, feature)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string">    base_ent -- 根节点的信息熵</span></span><br><span class="line"><span class="hljs-string">    feature -- 计算信息增益的特征</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    Ent -- 信息熵</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line"></span><br><span class="line">    feature_list = data[feature]  <span class="hljs-comment"># 得到一个特征的全部取值</span></span><br><span class="line">    unique_value = set(feature_list)  <span class="hljs-comment"># 特征取值的类别</span></span><br><span class="line">    feature_ent = <span class="hljs-number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">for</span> each_feature <span class="hljs-keyword">in</span> unique_value:</span><br><span class="line">        temp_data = data[data[feature] == each_feature]</span><br><span class="line">        weight = len(temp_data)/len(feature_list)  <span class="hljs-comment"># 计算该特征的权重值</span></span><br><span class="line">        temp_ent = weight*get_Ent(temp_data)</span><br><span class="line">        feature_ent = feature_ent+temp_ent</span><br><span class="line"></span><br><span class="line">    gain = base_ent - feature_ent  <span class="hljs-comment"># 信息增益</span></span><br><span class="line">    <span class="hljs-keyword">return</span> gain</span><br></pre></td></tr></table></figure>
<p>完成 <strong>信息增益</strong> 函数后，尝试计算特征 <code>hair</code> 的信息增益值。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_gain(data,base_ent,<span class="hljs-string">'hair'</span>)</span><br></pre></td></tr></table></figure>
<pre><code>0.062200515199107964
</code></pre><h4 id="信息增益率（C4-5）"><a href="#信息增益率（C4-5）" class="headerlink" title="信息增益率（C4.5）"></a>信息增益率（C4.5）</h4><p>信息增益也存在许多不足之处，经过大量的实验发现，当信息增益作为标准时，易偏向于取值较多的特征，为了避免这种偏好给预测结果带来的不好影响，可以使用<strong>增益率</strong>来选择最优划分。<strong>增益率</strong>的公式定义为:</p>
<p>$$<br>GainRatio(D,a)=\frac{Gain(D,a)}{IV(a)} \tag{3}<br>$$</p>
<p>其中：</p>
<p>$$<br>IV(a)=-\sum_{m=1}^{M}\frac{\left | D^{m} \right |}{\left | D \right |}\; log_{2}\frac{\left | D^{m} \right |}{\left | D \right |} \tag{4}<br>$$</p>
<p>`IV(a)` 称为特征 `a` 的固有值，当 `a` 的取值数目越多，则 `IV(a)` 的值通常会比较大。例如：</p>
<p>$$<br>IV(hair)= -\frac{9}{17}\; log_{2}\frac{9}{17}-\frac{8}{17}\; log_{2}\frac{8}{17}=0.998<br>$$</p>
<p>$$<br>IV(voice)= -\frac{7}{17}\; log_{2}\frac{7}{17}  -\frac{5}{17}\; log_{2}\frac{5}{17} - \frac{5}{17}\; log_{2}\frac{5}{17} = 1.566<br>$$</p>
<h3 id="连续值处理"><a href="#连续值处理" class="headerlink" title="连续值处理"></a>连续值处理</h3><p>在前面介绍的特征选择中，都是对离散型数据进行处理，但在实际的生活中数据常常会出现连续值的情况，如生成数据中的身高，当数据较少时，可以将每一个值作为一个类别，但当数据量大时，这样是不可取的，在 <strong>C4.5</strong> 算法中采用二分法对连续值进行处理。</p>
<p>对于连续的属性 `X` 假设共出现了 n 个不同的取值，将这些取值从小到大排序\(\{x_{1},x_{2},x_{3},…,x_{n} \} \)，其中找一点作为划分点 t ，则将数据划分为两类，大于 t 的为一类，小于 t 的为另一类。而 t 的取值通常为相邻两点的平均数 \(t=\frac{x_{i}+x_{i+1}}{2}\)。</p>
<p>则在 n 个连续值之中，可以作为划分点的 t 有 n-1 个。通过遍历可以像离散型一样来考察这些划分点。</p>
<p>$$<br>Gain(D,X)=Ent(D)-\frac{\left | D_{&lt;t} \right |}{\left | D \right |}Ent(D_{&lt;t})-\frac{\left | D_{&gt;t} \right |}{\left | D \right |}Ent(D_{&gt;t}) \tag{5}<br>$$</p>
<p>其中得到样本 `D` 基于划分点 t 二分后的信息增益，于是我们可以选择使得 `Gain(D,X)` 值最大的划分点。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""计算连续值的划分点</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_splitpoint</span><span class="hljs-params">(data, base_ent, feature)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string">    base_ent -- 根节点的信息熵</span></span><br><span class="line"><span class="hljs-string">    feature -- 需要划分的连续特征</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    final_t -- 连续值最优划分点</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-comment"># 将连续值进行排序并转化为浮点类型</span></span><br><span class="line">    continues_value = data[feature].sort_values().astype(np.float64)</span><br><span class="line">    continues_value = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> continues_value]  <span class="hljs-comment"># 不保留原来的索引</span></span><br><span class="line">    t_set = []</span><br><span class="line">    t_ent = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 得到划分点 t 的集合</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(continues_value)<span class="hljs-number">-1</span>):</span><br><span class="line">        temp_t = (continues_value[i]+continues_value[i+<span class="hljs-number">1</span>])/<span class="hljs-number">2</span></span><br><span class="line">        t_set.append(temp_t)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># 计算最优划分点</span></span><br><span class="line">    <span class="hljs-keyword">for</span> each_t <span class="hljs-keyword">in</span> t_set:</span><br><span class="line">        <span class="hljs-comment"># 将大于划分点的分为一类</span></span><br><span class="line">        temp1_data = data[data[feature].astype(np.float64) &gt; each_t]</span><br><span class="line">        <span class="hljs-comment"># 将小于划分点的分为一类</span></span><br><span class="line">        temp2_data = data[data[feature].astype(np.float64) &lt; each_t]</span><br><span class="line">        weight1 = len(temp1_data)/len(data)</span><br><span class="line">        weight2 = len(temp2_data)/len(data)</span><br><span class="line">        <span class="hljs-comment"># 计算每个划分点的信息增益</span></span><br><span class="line">        temp_ent = base_ent-weight1 * \</span><br><span class="line">            get_Ent(temp1_data)-weight2*get_Ent(temp2_data)</span><br><span class="line">        t_ent[each_t] = temp_ent</span><br><span class="line">    print(<span class="hljs-string">"t_ent:"</span>, t_ent)</span><br><span class="line">    final_t = max(t_ent, key=t_ent.get)</span><br><span class="line">    <span class="hljs-keyword">return</span> final_t</span><br></pre></td></tr></table></figure>
<p>实现连续值最优划分点的函数后，寻找 <code>height</code> 连续特征值的划分点。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final_t = get_splitpoint(data, base_ent, <span class="hljs-string">'height'</span>)</span><br><span class="line">final_t</span><br></pre></td></tr></table></figure>
<pre><code>t_ent: {158.0: 0.1179805181500242, 159.5: 0.1179805181500242, 161.0: 0.2624392604045631, 162.0: 0.2624392604045631, 163.0: 0.3856047022157598, 163.5: 0.15618502398692893, 164.0: 0.3635040117533678, 165.0: 0.33712865788827096, 167.0: 0.4752766311586692, 170.0: 0.32920899348970845, 172.0: 0.5728389611412551, 172.5: 0.4248356349861979, 173.5: 0.3165383509071513, 174.5: 0.22314940393447813, 176.5: 0.14078143361499595, 179.0: 0.06696192680347068}

172.0
</code></pre><h3 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h3><p>在对决策树中最佳特征选择和连续值处理之后，接下来就是对决策树的构建。</p>
<h4 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h4><p>首先我们将连续值进行处理，在找到最佳划分点之后，将 \(&lt; t\) 的值设为 0，将 \(&gt;= t\) 的值设为 1。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">choice_1</span><span class="hljs-params">(x, t)</span>:</span></span><br><span class="line">    <span class="hljs-keyword">if</span> x &gt; t:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"&gt;&#123;&#125;"</span>.format(t)</span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;&#123;&#125;"</span>.format(t)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">deal_data = data.copy()</span><br><span class="line"><span class="hljs-comment"># 使用lambda和map函数将 height 按照final_t划分为两个类别</span></span><br><span class="line">deal_data[<span class="hljs-string">"height"</span>] = pd.Series(</span><br><span class="line">    map(<span class="hljs-keyword">lambda</span> x: choice_1(int(x), final_t), deal_data[<span class="hljs-string">"height"</span>]))</span><br><span class="line">deal_data</span><br></pre></td></tr></table></figure>
<h4 id="选择最优划分特征"><a href="#选择最优划分特征" class="headerlink" title="选择最优划分特征"></a>选择最优划分特征</h4><p>将数据进行预处理之后，接下来就是选择最优的划分特征。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""选择最优划分特征</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">choose_feature</span><span class="hljs-params">(data)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    best_feature -- 最优的划分特征</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    num_features = len(data.columns) - <span class="hljs-number">1</span>  <span class="hljs-comment"># 特征数量</span></span><br><span class="line">    base_ent = get_Ent(data)</span><br><span class="line">    best_gain = <span class="hljs-number">0.0</span>  <span class="hljs-comment"># 初始化信息增益</span></span><br><span class="line">    best_feature = data.columns[<span class="hljs-number">0</span>]</span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_features):  <span class="hljs-comment"># 遍历所有特征</span></span><br><span class="line">        temp_gain = get_gain(data, base_ent, data.columns[i])    <span class="hljs-comment"># 计算信息增益</span></span><br><span class="line">        <span class="hljs-keyword">if</span> (temp_gain &gt; best_gain):  <span class="hljs-comment"># 选择最大的信息增益</span></span><br><span class="line">            best_gain = temp_gain</span><br><span class="line">            best_feature = data.columns[i]</span><br><span class="line">    <span class="hljs-keyword">return</span> best_feature  <span class="hljs-comment"># 返回最优特征</span></span><br></pre></td></tr></table></figure>
<p>完成函数之后，我们首先看看数据集中信息增益值最大的特征是什么？</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choose_feature(deal_data)</span><br></pre></td></tr></table></figure>
<pre><code>&apos;height&apos;
</code></pre><h4 id="构建决策树"><a href="#构建决策树" class="headerlink" title="构建决策树"></a>构建决策树</h4><p>在将所有的子模块构建好之后，最后就是对核心决策树的构建，本次实验采用<strong>信息增益（ID3）</strong>的方式构建决策树。在构建的过程中，根据算法流程，我们反复遍历数据集，计算每一个特征的信息增益，通过比较将最好的特征作为父节点，根据特征的值确定分支子节点，然后重复以上操作，直到某一个分支全部属于同一类别，或者遍历完所有的数据特征，当遍历到最后一个特征时，若分支数据依然“不纯”，就将其中数量较多的类别作为子节点。</p>
<p>因此最好采用递归的方式来构建决策树。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""构建决策树</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_tree</span><span class="hljs-params">(data)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    tree -- 以字典的形式返回决策树</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    feature_list = data.columns[:<span class="hljs-number">-1</span>].tolist()</span><br><span class="line">    label_list = data.iloc[:, <span class="hljs-number">-1</span>]</span><br><span class="line">    <span class="hljs-keyword">if</span> len(data[<span class="hljs-string">"labels"</span>].value_counts()) == <span class="hljs-number">1</span>:</span><br><span class="line">        leaf_node = data[<span class="hljs-string">"labels"</span>].mode().values</span><br><span class="line">        <span class="hljs-keyword">return</span> leaf_node            <span class="hljs-comment"># 第一个递归结束条件：所有的类标签完全相同</span></span><br><span class="line">    <span class="hljs-keyword">if</span> len(feature_list) == <span class="hljs-number">1</span>:</span><br><span class="line">        leaf_node = data[<span class="hljs-string">"labels"</span>].mode().values</span><br><span class="line">        <span class="hljs-keyword">return</span> leaf_node   <span class="hljs-comment"># 第二个递归结束条件：用完了所有特征</span></span><br><span class="line">    best_feature = choose_feature(data)   <span class="hljs-comment"># 最优划分特征</span></span><br><span class="line">    tree = &#123;best_feature: &#123;&#125;&#125;</span><br><span class="line">    feat_values = data[best_feature]</span><br><span class="line">    unique_value = set(feat_values)</span><br><span class="line">    <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> unique_value:</span><br><span class="line">        temp_data = data[data[best_feature] == value]</span><br><span class="line">        temp_data = temp_data.drop([best_feature], axis=<span class="hljs-number">1</span>)</span><br><span class="line">        tree[best_feature][value] = create_tree(temp_data)</span><br><span class="line">    <span class="hljs-keyword">return</span> tree</span><br></pre></td></tr></table></figure>
<p>完成创建决策树函数后，接下来对我们第一棵树进行创建。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tree = create_tree(deal_data)</span><br><span class="line">tree</span><br></pre></td></tr></table></figure>
<pre><code>{&apos;height&apos;: {&apos;&lt;172.0&apos;: {&apos;ear_stud&apos;: {&apos;no&apos;: {&apos;voice&apos;: {&apos;thick&apos;: array([&apos;man&apos;], dtype=object),
      &apos;medium&apos;: array([&apos;man&apos;], dtype=object),
      &apos;thin&apos;: array([&apos;woman&apos;], dtype=object)}},
    &apos;yes&apos;: array([&apos;woman&apos;], dtype=object)}},
  &apos;&gt;172.0&apos;: array([&apos;man&apos;], dtype=object)}}
</code></pre><p>通过字典的方式表示构建好的树，可以通过图像的方式更加直观的了解。</p>
<center><img src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh's%20blog/images/decision-making%20tree/2.png" width="400"></center>

<p>通过图形可以看出，在构建决策树时不一定每一个特征都会成为树的节点（如同 <code>hair</code>）。</p>
<h4 id="决策分类"><a href="#决策分类" class="headerlink" title="决策分类"></a>决策分类</h4><p>在构建好决策树之后，最终就可以使用未知样本进行预测分类。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""决策分类</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">classify</span><span class="hljs-params">(tree, test)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string">    test -- 需要测试的数据</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    class_label -- 分类结果</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    first_feature = list(tree.keys())[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 获取根节点</span></span><br><span class="line">    feature_dict = tree[first_feature]  <span class="hljs-comment"># 根节点下的树</span></span><br><span class="line">    labels = test.columns.tolist()</span><br><span class="line">    value = test[first_feature][<span class="hljs-number">0</span>]</span><br><span class="line">    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> feature_dict.keys():</span><br><span class="line">        <span class="hljs-keyword">if</span> value == key:</span><br><span class="line">            <span class="hljs-keyword">if</span> type(feature_dict[key]).__name__ == <span class="hljs-string">'dict'</span>:  <span class="hljs-comment"># 判断该节点是否为叶节点</span></span><br><span class="line">                class_label = classify(feature_dict[key], test)  <span class="hljs-comment"># 采用递归直到遍历到叶节点</span></span><br><span class="line">            <span class="hljs-keyword">else</span>:</span><br><span class="line">                class_label = feature_dict[key]</span><br><span class="line">    <span class="hljs-keyword">return</span> class_label</span><br></pre></td></tr></table></figure>
<p>在分类函数完成之后，接下来我们尝试对未知数据进行分类。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test = pd.DataFrame(&#123;<span class="hljs-string">"hair"</span>: [<span class="hljs-string">"long"</span>], <span class="hljs-string">"voice"</span>: [<span class="hljs-string">"thin"</span>], <span class="hljs-string">"height"</span>: [<span class="hljs-number">163</span>], <span class="hljs-string">"ear_stud"</span>: [<span class="hljs-string">"yes"</span>]&#125;)</span><br><span class="line">test</span><br></pre></td></tr></table></figure>
<p>对连续值进行预处理。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test[<span class="hljs-string">"height"</span>] = pd.Series(map(<span class="hljs-keyword">lambda</span> x: choice_1(int(x), final_t), test[<span class="hljs-string">"height"</span>]))</span><br><span class="line">test</span><br></pre></td></tr></table></figure>
<p>分类预测。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">classify(tree,test)</span><br></pre></td></tr></table></figure>
<pre><code>array([&apos;woman&apos;], dtype=object)
</code></pre><p>一个身高 163 厘米，长发，带着耳钉且声音纤细的人，在我们构建的决策树判断后预测为一名女性。</p>
<p>上面的实验中，我们没有考虑 <code>=划分点</code> 的情况，你可以自行尝试将 <code>&gt;=划分点</code> 或 <code>&lt;=划分点</code> 归为一类，看看结果又有哪些不同？</p>
<h3 id="预剪枝和后剪枝"><a href="#预剪枝和后剪枝" class="headerlink" title="预剪枝和后剪枝"></a>预剪枝和后剪枝</h3><p>在决策树的构建过程中，特别在数据特征非常多时，为了尽可能正确的划分每一个训练样本，结点的划分就会不停的重复，则一棵决策树的分支就非常多。对于训练集而言，拟合出来的模型是非常完美的。但是，这种完美就使得整体模型的复杂度变高，同时对其他数据集的预测能力下降，也就是我们常说的过拟合使得模型的泛化能力变弱。为了避免过拟合问题的出现，在决策树中最常见的两种方法就是预剪枝和后剪枝。</p>
<h4 id="预剪枝"><a href="#预剪枝" class="headerlink" title="预剪枝"></a>预剪枝</h4><p>预剪枝，顾名思义预先减去枝叶，在构建决策树模型的时候，每一次对数据划分之前进行估计，如果当前节点的划分不能带来决策树泛化的提升，则停止划分并将当前节点标记为叶节点。例如前面构造的决策树，按照决策树的构建原则，通过 <code>height</code> 特征进行划分后 <code>&lt;172</code> 分支中又按照 <code>ear_stud</code> 特征值进行继续划分。如果应用预剪枝，则当通过 <code>height</code> 进行特征划分之后，对 <code>&lt;172</code> 分支是否进行 <code>ear_stud</code> 特征进行划分时计算划分前后的准确度，如果划分后的更高则按照 <code>ear_stud</code> 继续划分，如果更低则停止划分。</p>
<h4 id="后剪枝"><a href="#后剪枝" class="headerlink" title="后剪枝"></a>后剪枝</h4><p>跟预剪枝在构建决策树的过程中判断是否继续特征划分所不同的是，后剪枝在决策树构建好之后对树进行修剪。如果说预剪枝是自顶向下的修剪，那么后剪枝就是自底向上进行修剪。后剪枝将最后的分支节点替换为叶节点，判断是否带来决策树泛化的提升，是则进行修剪，并将该分支节点替换为叶节点，否则不进行修剪。例如在前面构建好决策树之后，<code>&gt;172</code>分支的 <code>voice</code> 特征，将其替换为叶节点如（<code>man</code>），计算替换前后划分准确度，如果替换后准确度更高则进行修剪（用叶节点替换分支节点），否则不修剪。</p>
<h2 id="预测分类"><a href="#预测分类" class="headerlink" title="预测分类"></a>预测分类</h2><p>在前面我们使用 <code>python</code> 将决策树的特征选择，连续值处理和预测分类做了详细的讲解。接下来我们应用决策树模型对真实的数据进行分类预测。</p>
<h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><p>本次应用到的数据为学生成绩数据集 <code>course-13-student.csv</code>，一共有 395 条数据，26 个特征。</p>
<blockquote>
<p>数据集下载 👉 <a href="http://labfile.oss.aliyuncs.com/courses/1081/course-13-student.csv" target="_blank" rel="noopener">传送门</a></p>
</blockquote>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""导入数据集并预览</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">stu_grade = pd.read_csv(<span class="hljs-string">'course-13-student.csv'</span>)</span><br><span class="line">stu_grade.head()</span><br></pre></td></tr></table></figure>
<p>由于特征过多，我们选择部分特征作为决策树模型的分类特征,分别为：</p>
<ul>
<li><code>school</code>：学生所读学校(<code>GP</code>，<code>MS</code>)</li>
<li><code>sex</code>: 性别(<code>F</code>：女，<code>M</code>：男)</li>
<li><code>address</code>: 家庭住址(<code>U</code>：城市，<code>R</code>：郊区)</li>
<li><code>Pstatus</code>: 父母状态(<code>A</code>：同居，<code>T</code>：分居)</li>
<li><code>Pedu</code>: 父母学历由低到高</li>
<li><code>reason</code>: 选择这所学校的原因(<code>home</code>：家庭,<code>course</code>：课程设计，<code>reputation</code>：学校地位，<code>other</code>：其他)</li>
<li><code>guardian</code>: 监护人(<code>mother</code>：母亲，<code>father</code>：父亲，<code>other</code>：其他)</li>
<li><code>studytime</code>: 周末学习时长</li>
<li><code>schoolsup</code>: 额外教育支持(<code>yes</code>：有，<code>no</code>：没有)</li>
<li><code>famsup</code>: 家庭教育支持(<code>yes</code>：有，<code>no</code>：没有)</li>
<li><code>paid</code>: 是否上补习班(<code>yes</code>：是，<code>no</code>：否)</li>
<li><code>higher</code>: 是否想受更好的教育(<code>yes</code>：是，<code>no</code>：否)</li>
<li><code>internet</code>: 是否家里联网(<code>yes</code>：是，<code>no</code>：否)</li>
<li><code>G1</code>: 一阶段测试成绩</li>
<li><code>G2</code>: 二阶段测试成绩</li>
<li><code>G3</code>: 最终成绩</li>
</ul>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">new_data = stu_grade.iloc[:, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>]]</span><br><span class="line">new_data.head()</span><br></pre></td></tr></table></figure>
<h3 id="数据预处理-1"><a href="#数据预处理-1" class="headerlink" title="数据预处理"></a>数据预处理</h3><p>首先我们将成绩 <code>G1</code>，<code>G2</code>，<code>G3</code> 根据分数进行等级划分，将 <code>0-4</code> 划分为 <code>bad</code>，<code>5-9</code> 划分为 <code>medium</code> ，</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">choice_2</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    x = int(x)</span><br><span class="line">    <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">5</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"bad"</span></span><br><span class="line">    <span class="hljs-keyword">elif</span> x &gt;= <span class="hljs-number">5</span> <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">10</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"medium"</span></span><br><span class="line">    <span class="hljs-keyword">elif</span> x &gt;= <span class="hljs-number">10</span> <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">15</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"good"</span></span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"excellent"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu_data = new_data.copy()</span><br><span class="line">stu_data[<span class="hljs-string">"G1"</span>] = pd.Series(map(<span class="hljs-keyword">lambda</span> x: choice_2(x), stu_data[<span class="hljs-string">"G1"</span>]))</span><br><span class="line">stu_data[<span class="hljs-string">"G2"</span>] = pd.Series(map(<span class="hljs-keyword">lambda</span> x: choice_2(x), stu_data[<span class="hljs-string">"G2"</span>]))</span><br><span class="line">stu_data[<span class="hljs-string">"G3"</span>] = pd.Series(map(<span class="hljs-keyword">lambda</span> x: choice_2(x), stu_data[<span class="hljs-string">"G3"</span>]))</span><br><span class="line">stu_data.head()</span><br></pre></td></tr></table></figure>
<p>同样我们对 <code>Pedu</code> （父母教育程度）也进行划分</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">choice_3</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    x = int(x)</span><br><span class="line">    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">3</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"high"</span></span><br><span class="line">    <span class="hljs-keyword">elif</span> x &gt; <span class="hljs-number">1.5</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"medium"</span></span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">"low"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu_data[<span class="hljs-string">"Pedu"</span>] = pd.Series(map(<span class="hljs-keyword">lambda</span> x: choice_3(x), stu_data[<span class="hljs-string">"Pedu"</span>]))</span><br><span class="line">stu_data.head()</span><br></pre></td></tr></table></figure>
<p>在等级划分之后，为遵循 <code>scikit-learn</code> 函数的输入规范，需要将数据特征进行替换。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""特征值替换</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">replace_feature</span><span class="hljs-params">(data)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    data -- 数据集</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    data -- 将特征值替换后的数据集</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> data.columns:  <span class="hljs-comment"># 遍历每一个特征名称</span></span><br><span class="line">        feature_list = data[each]</span><br><span class="line">        unique_value = set(feature_list)</span><br><span class="line">        i = <span class="hljs-number">0</span></span><br><span class="line">        <span class="hljs-keyword">for</span> fea_value <span class="hljs-keyword">in</span> unique_value:</span><br><span class="line">            data[each] = data[each].replace(fea_value, i)</span><br><span class="line">            i += <span class="hljs-number">1</span></span><br><span class="line">    <span class="hljs-keyword">return</span> data</span><br></pre></td></tr></table></figure>
<p>将特征值进行替换后展示。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stu_data = replace_feature(stu_data)</span><br><span class="line">stu_data.head(<span class="hljs-number">10</span>)</span><br></pre></td></tr></table></figure>
<h3 id="数据划分"><a href="#数据划分" class="headerlink" title="数据划分"></a>数据划分</h3><p>加载好预处理的数据集之后，为了实现决策树算法，同样我们需要将数据集分为 <strong>训练集</strong>和<strong>测试集</strong>，依照经验：<strong>训练集</strong>占比为 70%，<strong>测试集</strong>占 30%。</p>
<p>同样在此我们使用 <code>scikit-learn</code> 模块的 <code>train_test_split</code> 函数完成数据集切分。<br><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">x_train,x_test, y_train, y_test =train_test_split(train_data,train_target,test_size=<span class="hljs-number">0.4</span>, random_state=<span class="hljs-number">0</span>)</span><br></pre></td></tr></table></figure></p>
<p>其中：</p>
<ul>
<li><code>x_train</code>,<code>x_test</code>, <code>y_train</code>, <code>y_test</code> 分别表示，切分后的 特征的训练集，特征的测试集，标签的训练集，标签的测试集；其中特征和标签的值是一一对应的。  </li>
<li><code>train_data</code>,<code>train_target</code>分别表示为待划分的特征集和待划分的标签集。</li>
<li><code>test_size</code>：测试样本所占比例。</li>
<li><code>random_state</code>：随机数种子,在需要重复实验时，保证在随机数种子一样时能得到一组一样的随机数。</li>
</ul>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(stu_data.iloc[:, :<span class="hljs-number">-1</span>], stu_data[<span class="hljs-string">"G3"</span>], </span><br><span class="line">                                                    test_size=<span class="hljs-number">0.3</span>, random_state=<span class="hljs-number">5</span>)</span><br><span class="line"></span><br><span class="line">x_test</span><br></pre></td></tr></table></figure>
<h3 id="决策树构建"><a href="#决策树构建" class="headerlink" title="决策树构建"></a>决策树构建</h3><p>在划分好数据集之后，接下来就是进行预测。在前面的实验中我们采用 <code>python</code> 对决策树算法进行实现，下面我们通过 <code>scikit-learn</code> 来对其进行实现。 <code>scikit-learn</code> 决策树类及常用参数如下：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DecisionTreeClassifier(criterion=’gini’，random_state=<span class="hljs-keyword">None</span>)</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li><code>criterion</code> 表示特征划分方法选择，默认为 <code>gini</code> (在后面会讲到)，可选择为 <code>entropy</code> (信息增益)。</li>
<li><code>ramdom_state</code> 表示随机数种子，当特征特别多时 <code>scikit-learn</code> 为了提高效率，随机选取部分特征来进行特征选择，即找到所有特征中较优的特征。</li>
</ul>
<p>常用方法:  </p>
<ul>
<li><code>fit(x,y)</code>训练决策树。</li>
<li><code>predict(X)</code> 对数据集进行预测返回预测结果。</li>
</ul>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line">dt_model = DecisionTreeClassifier(criterion=<span class="hljs-string">'entropy'</span>, random_state=<span class="hljs-number">34</span>)</span><br><span class="line">dt_model.fit(x_train,y_train) <span class="hljs-comment"># 使用训练集训练模型</span></span><br></pre></td></tr></table></figure>
<pre><code>DecisionTreeClassifier(class_weight=None, criterion=&apos;entropy&apos;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=34,
            splitter=&apos;best&apos;)
</code></pre><h3 id="决策树可视化"><a href="#决策树可视化" class="headerlink" title="决策树可视化"></a>决策树可视化</h3><p>在构建好决策树之后，我们需要对创建好的决策树进行可视化展示，引入 <code>export_graphviz</code> 进行画图。由于环境中没有函数需要进行安装。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Linux</span><br><span class="line">!apt-get install --yes graphviz # 安装所需模块</span><br><span class="line">!pip install graphviz</span><br><span class="line"></span><br><span class="line"># windows Anaconda</span><br><span class="line">conda install graphviz</span><br></pre></td></tr></table></figure>
<p>下面开始生成决策树图像，其中生成决策树较大需要拖动滑动条进行查看。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> export_graphviz</span><br><span class="line"><span class="hljs-keyword">import</span> graphviz</span><br><span class="line"></span><br><span class="line">img = export_graphviz(</span><br><span class="line">    dt_model, out_file=<span class="hljs-keyword">None</span>,</span><br><span class="line">    feature_names=stu_data.columns[:<span class="hljs-number">-1</span>].values.tolist(),  <span class="hljs-comment"># 传入特征名称</span></span><br><span class="line">    class_names=np.array([<span class="hljs-string">"bad"</span>, <span class="hljs-string">"medium"</span>, <span class="hljs-string">"good"</span>, <span class="hljs-string">"excellent"</span>]),  <span class="hljs-comment"># 传入类别值</span></span><br><span class="line">    filled=<span class="hljs-keyword">True</span>, node_ids=<span class="hljs-keyword">True</span>,</span><br><span class="line">    rounded=<span class="hljs-keyword">True</span>)</span><br><span class="line"></span><br><span class="line">graphviz.Source(img)  <span class="hljs-comment"># 展示决策树</span></span><br></pre></td></tr></table></figure>
<p><img src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/decision-making%20tree/output_157_0.svg" alt="svg"></p>
<h3 id="模型预测"><a href="#模型预测" class="headerlink" title="模型预测"></a>模型预测</h3><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_predict = dt_model.predict(x_test) <span class="hljs-comment"># 使用模型对测试集进行预测</span></span><br><span class="line">y_predict</span><br></pre></td></tr></table></figure>
<pre><code>array([3, 1, 2, 0, 0, 2, 0, 2, 2, 2, 2, 0, 2, 3, 0, 3, 2, 0, 3, 2, 2, 0,
       3, 2, 2, 0, 3, 3, 2, 2, 0, 0, 0, 2, 1, 0, 1, 2, 3, 0, 3, 3, 2, 2,
       0, 2, 2, 2, 2, 2, 3, 2, 2, 0, 3, 0, 2, 2, 2, 1, 3, 0, 2, 2, 2, 2,
       3, 3, 2, 0, 0, 0, 1, 2, 2, 0, 0, 3, 0, 3, 2, 3, 2, 2, 3, 1, 0, 0,
       0, 2, 1, 2, 2, 2, 2, 3, 0, 0, 3, 0, 0, 2, 3, 2, 1, 2, 2, 0, 0, 2,
       0, 2, 0, 3, 2, 2, 2, 3, 2], dtype=int64)
</code></pre><h3 id="分类准确率计算"><a href="#分类准确率计算" class="headerlink" title="分类准确率计算"></a>分类准确率计算</h3><p>当我们训练好模型并进行分类预测之后，可以通过比对预测结果和真实结果得到预测的准确率。</p>
<p>$$<br>accur=\frac{\sum_{i=1}^{N}I(\bar{y_{i}}=y_{i})}{N} \tag{6}<br>$$</p>
<p>公式(6)中 `N` 表示数据总条数，\(\bar{y_{i}}\) 表示第 `i` 条数据的种类预测值，`y_{i}` 表示第 `i` 条数据的种类真实值，`I` 同样是指示函数，表示 \(\bar{y_{i}}\) 和 `y_{i}` 相同的个数。</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"""准确率计算</span></span><br><span class="line"><span class="hljs-string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_accuracy</span><span class="hljs-params">(test_labels, pred_labels)</span>:</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    参数:</span></span><br><span class="line"><span class="hljs-string">    test_labels -- 测试集的真实值</span></span><br><span class="line"><span class="hljs-string">    pred_labels -- 测试集的预测值</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">    返回:</span></span><br><span class="line"><span class="hljs-string">    accur -- 准确率</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    correct = np.sum(test_labels == pred_labels)  <span class="hljs-comment"># 计算预测正确的数据个数</span></span><br><span class="line">    n = len(test_labels)  <span class="hljs-comment"># 总测试集数据个数</span></span><br><span class="line">    accur = correct/n</span><br><span class="line">    <span class="hljs-keyword">return</span> accur</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_accuracy(y_test, y_predict)</span><br></pre></td></tr></table></figure>
<pre><code>0.6974789915966386
</code></pre><h2 id="CART-决策树"><a href="#CART-决策树" class="headerlink" title="CART 决策树"></a>CART 决策树</h2><p>分类与回归树（classification and regression tree, CART）同样也是应用广泛的决策树学习算法，CART 算法是按照特征划分，由树的生成和树的剪枝构成，既可以进行分类又可以用于回归，按照作用将其分为决策树和回归树，由于本实验设计为决策树的概念，所以回归树的部分有兴趣的同学可以自己查找相关资料进一步学习。</p>
<p>CART决策树的构建和常见的 <strong>ID3</strong> 和 <strong>C4.5</strong> 算法的流程相似，但在特征划分选择上CART选择了 <strong>基尼指数</strong> 作为划分标准。数据集 `D` 的纯度可用基尼值来度量：</p>
<p>$$<br>Gini(D) = \sum_{y=1}^{\left|y \right|}\sum_{k’\neq k}^{}p_{k}p_{k}’\tag{7}<br>$$</p>
<p><strong>基尼指数</strong>表示随机抽取两个样本，两个样本类别不一致的概率，<strong>基尼指数</strong>越小则数据集的纯度越高。同样对于每一个特征值的基尼指数计算，其和 <strong>ID3</strong> 、 <strong>C4.5</strong> 相似，定义为：</p>
<p>$$<br>GiniValue(D,a)=\sum_{m=1}^{M}\frac{\left |D^{m}  \right |}{\left |D  \right |}Gini(D^{m}) \tag{8}<br>$$</p>
<p>在进行特征划分的时候，选择特征中基尼值最小的作为最优特征划分点。  </p>
<p>实际上，在应用过程中，更多的会使用 <strong>基尼指数</strong> 对特征划分点进行决策，最重要的原因是计算复杂度相较于 <strong>ID3</strong> 和 <strong>C4.5</strong> 小很多（没有对数运算）。</p>
<p><strong>拓展阅读：</strong></p>
<ul>
<li><a href="https://zh.wikipedia.org/zh-hans/决策树" target="_blank" rel="noopener">决策树- 维基百科</a></li>
</ul>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/decision-tree/">decision tree</a>, <a class="has-link-grey -link" href="/tags/machine-learning/">machine learning</a>, <a class="has-link-grey -link" href="/tags/python/">python</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>支付宝</span>
    <div class="qrcode"><img src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/reward/alipay-reward-image.jpg" alt="支付宝"></div>
</a>

                
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>微信</span>
    <div class="qrcode"><img src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/reward/wechat-reward-image.jpg" alt="微信"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2019/02/07/Bagging_and_Boosting/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">机器学习|装袋和提升方法详解 (Python 语言描述)</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2019/01/31/Neural_Network/">
                <span class="level-item">机器学习|感知机和人工神经网络详解 (Python 语言描述)</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="valine-thread"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: true,
        verify: false,
        app_id: 'zzN9t0v9tihDucYhBujOYJUJ-gzGzoHsz',
        app_key: 'gngT5gD2rOh2hc7C62097Ql6',
        placeholder: 'Say something...'
    });
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    <img class="image is-128x128 has-mb-6" src="https://avatars0.githubusercontent.com/u/38065710?s=400&amp;u=80ee4d360562451484188e6f1677fa442720891b&amp;v=4" alt="Laugh">
                    
                    <p class="is-size-4 is-block">
                        Laugh
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        The life I want, there is no shortcut.
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Northern Hemisphere</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        20
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        23
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        27
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="http://github.com/laugh12321">
                follow</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="http://github.com/laugh12321">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Steam" href="https://steamcommunity.com/profiles/76561198445204275/">
                
                <i class="fab fa-steam-square"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://styx11.github.io/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Styx</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">styx11.github.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="http://luuuuyang.com/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Luuuuyang</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">luuuuyang.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.vseu.com/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">幸运草</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.vseu.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://tea9.xyz/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">tea9</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">tea9.xyz</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://hongjay233.github.io/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">HongJay</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hongjay233.github.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.itfire.cn/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">仓鼠‘s blog</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.itfire.cn</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://blog.wzy1999.wang/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">执念</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">blog.wzy1999.wang</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Python/排序算法/">
            <span class="level-start">
                <span class="level-item">排序算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Ubuntu/">
            <span class="level-start">
                <span class="level-item">Ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Ubuntu/ECS/">
            <span class="level-start">
                <span class="level-item">ECS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/博客/">
            <span class="level-start">
                <span class="level-item">博客</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/博客/GitHub-Pages/">
            <span class="level-start">
                <span class="level-item">GitHub Pages</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/博客/主题优化/">
            <span class="level-start">
                <span class="level-item">主题优化</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/机器学习/">
            <span class="level-start">
                <span class="level-item">机器学习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/机器学习/K-Means/">
            <span class="level-start">
                <span class="level-item">K-Means</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/K-近邻算法/">
            <span class="level-start">
                <span class="level-item">K-近邻算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/决策树/">
            <span class="level-start">
                <span class="level-item">决策树</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/多项式回归/">
            <span class="level-start">
                <span class="level-item">多项式回归</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/感知机/">
            <span class="level-start">
                <span class="level-item">感知机</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/支持向量机/">
            <span class="level-start">
                <span class="level-item">支持向量机</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/朴素贝叶斯/">
            <span class="level-start">
                <span class="level-item">朴素贝叶斯</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/线性回归/">
            <span class="level-start">
                <span class="level-item">线性回归</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/机器学习/装袋/">
            <span class="level-start">
                <span class="level-item">装袋</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/深度学习/">
            <span class="level-start">
                <span class="level-item">深度学习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/ECS/" style="font-size: 13.33px;">ECS</a> <a href="/tags/HAC/" style="font-size: 10px;">HAC</a> <a href="/tags/MAE/" style="font-size: 10px;">MAE</a> <a href="/tags/MAPE/" style="font-size: 10px;">MAPE</a> <a href="/tags/MSE/" style="font-size: 10px;">MSE</a> <a href="/tags/Seafile/" style="font-size: 10px;">Seafile</a> <a href="/tags/Ubuntu/" style="font-size: 13.33px;">Ubuntu</a> <a href="/tags/artificial-neural-network/" style="font-size: 10px;">artificial neural network</a> <a href="/tags/bagging/" style="font-size: 10px;">bagging</a> <a href="/tags/blog/" style="font-size: 13.33px;">blog</a> <a href="/tags/boosting/" style="font-size: 10px;">boosting</a> <a href="/tags/cluster/" style="font-size: 10px;">cluster</a> <a href="/tags/decision-tree/" style="font-size: 10px;">decision tree</a> <a href="/tags/deep-learning/" style="font-size: 10px;">deep learning</a> <a href="/tags/github/" style="font-size: 13.33px;">github</a> <a href="/tags/jekyll/" style="font-size: 10px;">jekyll</a> <a href="/tags/k-means/" style="font-size: 13.33px;">k-means</a> <a href="/tags/k-nearest-neighbors/" style="font-size: 10px;">k-nearest neighbors</a> <a href="/tags/linear-regression/" style="font-size: 13.33px;">linear regression</a> <a href="/tags/machine-learning/" style="font-size: 16.67px;">machine learning</a> <a href="/tags/naive-bayes/" style="font-size: 10px;">naive bayes</a> <a href="/tags/next/" style="font-size: 10px;">next</a> <a href="/tags/perceptron/" style="font-size: 10px;">perceptron</a> <a href="/tags/polynomial-regression/" style="font-size: 10px;">polynomial regression</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/sort/" style="font-size: 13.33px;">sort</a> <a href="/tags/support-vector-machine/" style="font-size: 10px;">support vector machine</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/02/11/Hierarchical_clustering_method/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/12.jpg" alt="机器学习|层次聚类方法 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-10T16:00:00.000Z">2019-02-11</time></div>
                    <a href="/2019/02/11/Hierarchical_clustering_method/" class="has-link-black-ter is-size-6">机器学习|层次聚类方法 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/09/Cluster_Of_K-Means/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/10.jpg" alt="机器学习|划分聚类之 K-Means 详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-08T16:00:00.000Z">2019-02-09</time></div>
                    <a href="/2019/02/09/Cluster_Of_K-Means/" class="has-link-black-ter is-size-6">机器学习|划分聚类之 K-Means 详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/09/Image_compression_using_Mini_Batch_k-means/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/11.jpg" alt="使用 Mini Batch K-Means 进行图像压缩 ">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-08T16:00:00.000Z">2019-02-09</time></div>
                    <a href="/2019/02/09/Image_compression_using_Mini_Batch_k-means/" class="has-link-black-ter is-size-6">使用 Mini Batch K-Means 进行图像压缩 </a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/07/Bagging_and_Boosting/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/09.jpg" alt="机器学习|装袋和提升方法详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-06T16:00:00.000Z">2019-02-07</time></div>
                    <a href="/2019/02/07/Bagging_and_Boosting/" class="has-link-black-ter is-size-6">机器学习|装袋和提升方法详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/装袋/">装袋</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/01/Decision_Tree/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/08.jpg" alt="机器学习|决策树详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-01-31T16:00:00.000Z">2019-02-01</time></div>
                    <a href="/2019/02/01/Decision_Tree/" class="has-link-black-ter is-size-6">机器学习|决策树详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/决策树/">决策树</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ECS/">
                        <span class="tag">ECS</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HAC/">
                        <span class="tag">HAC</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAE/">
                        <span class="tag">MAE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAPE/">
                        <span class="tag">MAPE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MSE/">
                        <span class="tag">MSE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Seafile/">
                        <span class="tag">Seafile</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ubuntu/">
                        <span class="tag">Ubuntu</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/artificial-neural-network/">
                        <span class="tag">artificial neural network</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bagging/">
                        <span class="tag">bagging</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/blog/">
                        <span class="tag">blog</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/boosting/">
                        <span class="tag">boosting</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/cluster/">
                        <span class="tag">cluster</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/decision-tree/">
                        <span class="tag">decision tree</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/deep-learning/">
                        <span class="tag">deep learning</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/github/">
                        <span class="tag">github</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jekyll/">
                        <span class="tag">jekyll</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/k-means/">
                        <span class="tag">k-means</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/k-nearest-neighbors/">
                        <span class="tag">k-nearest neighbors</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linear-regression/">
                        <span class="tag">linear regression</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/machine-learning/">
                        <span class="tag">machine learning</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/naive-bayes/">
                        <span class="tag">naive bayes</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/next/">
                        <span class="tag">next</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/perceptron/">
                        <span class="tag">perceptron</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/polynomial-regression/">
                        <span class="tag">polynomial regression</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/python/">
                        <span class="tag">python</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/sort/">
                        <span class="tag">sort</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/support-vector-machine/">
                        <span class="tag">support vector machine</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/02/11/Hierarchical_clustering_method/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/12.jpg" alt="机器学习|层次聚类方法 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-10T16:00:00.000Z">2019-02-11</time></div>
                    <a href="/2019/02/11/Hierarchical_clustering_method/" class="has-link-black-ter is-size-6">机器学习|层次聚类方法 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/09/Cluster_Of_K-Means/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/10.jpg" alt="机器学习|划分聚类之 K-Means 详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-08T16:00:00.000Z">2019-02-09</time></div>
                    <a href="/2019/02/09/Cluster_Of_K-Means/" class="has-link-black-ter is-size-6">机器学习|划分聚类之 K-Means 详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/09/Image_compression_using_Mini_Batch_k-means/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/11.jpg" alt="使用 Mini Batch K-Means 进行图像压缩 ">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-08T16:00:00.000Z">2019-02-09</time></div>
                    <a href="/2019/02/09/Image_compression_using_Mini_Batch_k-means/" class="has-link-black-ter is-size-6">使用 Mini Batch K-Means 进行图像压缩 </a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/K-Means/">K-Means</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/07/Bagging_and_Boosting/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/09.jpg" alt="机器学习|装袋和提升方法详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-02-06T16:00:00.000Z">2019-02-07</time></div>
                    <a href="/2019/02/07/Bagging_and_Boosting/" class="has-link-black-ter is-size-6">机器学习|装袋和提升方法详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/装袋/">装袋</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/02/01/Decision_Tree/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://laugh12321-1258080753.cos.ap-chengdu.myqcloud.com/laugh&#39;s%20blog/images/photo/08.jpg" alt="机器学习|决策树详解 (Python 语言描述)">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-01-31T16:00:00.000Z">2019-02-01</time></div>
                    <a href="/2019/02/01/Decision_Tree/" class="has-link-black-ter is-size-6">机器学习|决策树详解 (Python 语言描述)</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a> / <a class="has-link-grey -link" href="/categories/机器学习/决策树/">决策树</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ECS/">
                        <span class="tag">ECS</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HAC/">
                        <span class="tag">HAC</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAE/">
                        <span class="tag">MAE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MAPE/">
                        <span class="tag">MAPE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MSE/">
                        <span class="tag">MSE</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Seafile/">
                        <span class="tag">Seafile</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Ubuntu/">
                        <span class="tag">Ubuntu</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/artificial-neural-network/">
                        <span class="tag">artificial neural network</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bagging/">
                        <span class="tag">bagging</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/blog/">
                        <span class="tag">blog</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/boosting/">
                        <span class="tag">boosting</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/cluster/">
                        <span class="tag">cluster</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/decision-tree/">
                        <span class="tag">decision tree</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/deep-learning/">
                        <span class="tag">deep learning</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/github/">
                        <span class="tag">github</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/jekyll/">
                        <span class="tag">jekyll</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/k-means/">
                        <span class="tag">k-means</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/k-nearest-neighbors/">
                        <span class="tag">k-nearest neighbors</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linear-regression/">
                        <span class="tag">linear regression</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/machine-learning/">
                        <span class="tag">machine learning</span>
                        <span class="tag is-grey">13</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/naive-bayes/">
                        <span class="tag">naive bayes</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/next/">
                        <span class="tag">next</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/perceptron/">
                        <span class="tag">perceptron</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/polynomial-regression/">
                        <span class="tag">polynomial regression</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/python/">
                        <span class="tag">python</span>
                        <span class="tag is-grey">14</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/sort/">
                        <span class="tag">sort</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/support-vector-machine/">
                        <span class="tag">support vector machine</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="机器学习|决策树详解 (Python 语言描述)" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Laugh&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus">Icarus</a>
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
</body>
</html>